---
title: Data Driven Transformation of DOM
description: d3-selectionì˜ ê°œë…ê³¼ ë™ì‘ ë°©ì‹ì„ ì½”ë“œì™€ í•¨ê»˜ ì‚´í´ë´…ë‹ˆë‹¤.
author: jinyongp
date: 2022-04-16T02:47:11.774Z
lastmod: 2023-08-13T13:16:45.659Z
draft: false
tags:
  - d3.js
series:
  list: null
  prev: /posts/d3js/1
  next: /posts/d3js/3
---

# Introduction

[d3-selection](https://github.com/d3/d3-selection)ì€ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ DOMì„ ì¡°ì‘í•  ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

ì´ë²ˆ ì‹œë¦¬ì¦ˆëŠ” d3-forceì™€ ì—°ê³„í•˜ì—¬ Github Follower, Following ê´€ê³„ë§ ê·¸ë¦¬ê¸°ë¥¼ ëª©í‘œë¡œ í•˜ê³  ìˆìœ¼ë¯€ë¡œ êµ¬í˜„ ê³¼ì •ì—ì„œ í•„ìš”í•œ ë¶€ë¶„ì— ëŒ€í•´ì„œë§Œ ë‹¤ë£¨ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

ë“¤ì–´ê°€ê¸° ì „ì— `Selection` ê°ì²´ì— ëŒ€í•´ ì•Œì•„ë´…ì‹œë‹¤. d3-selectionìœ¼ë¡œ ì„ íƒí•œ ìš”ì†ŒëŠ” [`groups`ì™€ `parents` propertyë¥¼ ê°–ëŠ” `Selection` ê°ì²´](https://github.com/d3/d3-selection/blob/main/src/selection/index.js)ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. `Selection` ê°ì²´ëŠ” ì„ íƒí•œ ìš”ì†Œë¥¼ ì œì–´í•  ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ ë©”ì„œë“œë¥¼ ì œê³µí•©ë‹ˆë‹¤.

- ìš”ì†Œ ì„ íƒ: selection, select, selectAll, selectChild, selectChildren, filter, merge
- ìš”ì†Œ ë³€ê²½: attr, classed, style, property, text, html, append, insert, remove, clone, sort, order, raise, lower
- ë°ì´í„° ì—°ê²°: data, join, enter, exit, datum
- ì´ë²¤íŠ¸ í•¸ë“¤ë§: on, dispatch
- ì œì–´ íë¦„: each, call, empty, nodes, size, \[Symbol.iterator\]()

d3-selectionì„ ì´ìš©í•˜ì—¬ ì„ íƒí•œ ìš”ì†Œì— ë°ì´í„°ë¥¼ ì—°ê²°í•˜ê³  ê·¸ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìš”ì†Œë¥¼ ì œì–´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ì œ ì½”ë“œì™€ í•¨ê»˜ d3-selectionì„ ì´ìš©í•˜ì—¬ ê°„ë‹¨í•œ ê·¸ë˜í”„ë¥¼ ê·¸ë ¤ë³´ê² ìŠµë‹ˆë‹¤.

---

## Creating and Editing

ê´€ê³„ë§ì— ì‚¬ìš©í•  `nodes`ì™€ `links`ë¥¼ ë¸Œë¼ìš°ì €ì— ê·¸ë ¤ì£¼ê¸° ìœ„í•´ d3-selectionìœ¼ë¡œ `svg`ë¥¼ ìƒì„±í•˜ê³  í¬ê¸°ë¥¼ ì„¤ì •í•´ì¤ë‹ˆë‹¤.

```javascript
const root = d3
  .select('body') // === d3.select(document.body)
  .append('svg')
  .attr('width', '100%')
  .attr('height', '100%')
  .style('display', 'block');
```

`body` ìš”ì†Œë¥¼ ì„ íƒí•˜ê³  í•˜ìœ„ì— `svg` ìš”ì†Œë¥¼ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  `attr` ë©”ì„œë“œì™€ `style` ë©”ì„œë“œë¡œ `svg`ì˜ ì†ì„±ê³¼ ìŠ¤íƒ€ì¼ì„ ì§€ì •í–ˆìŠµë‹ˆë‹¤. `root`ì—” `svg` ìš”ì†Œë¥¼ ë‹´ê³  ìˆëŠ” `Selection` ê°ì²´ê°€ í• ë‹¹ë©ë‹ˆë‹¤.

`root` ì•„ë˜ `links`ì™€ `nodes`ë¥¼ ê°ê° ë¬¶ì„ `g` ìš”ì†Œë¥¼ ìƒì„±í•©ë‹ˆë‹¤. (`linkGroup`ì„ ë¨¼ì € ìƒì„±í•´ì•¼ ë’¤ì— ë°°ì¹˜ë©ë‹ˆë‹¤.)

```javascript
const linkGroup = root.append('g').attr('id', 'links');
const nodeGroup = root.append('g').attr('id', 'nodes');
```

`id`ëŠ” ë³„ ë‹¤ë¥¸ ì—­í•  ì—†ì´ ì‹ë³„ì„ ìœ„í•´ ì¶”ê°€í•´ì£¼ì—ˆìŠµë‹ˆë‹¤.

---

## Joining Data

ì´ì œ DOM ìš”ì†Œì— ë°ì´í„°ë¥¼ ì—°ê²°í•´ë´…ì‹œë‹¤. `nodeGroup` ì•„ë˜ `circle`ì„ ë°°ì¹˜í•˜ê³  `nodes` ë°ì´í„°ë¥¼ ì—°ê²°í•©ë‹ˆë‹¤.

```javascript
const circles = nodeGroup
  .selectAll('circle')
  .data(nodes)
  .join('circle')
  .attr('r', 5)
  .attr('fill', 'blue');
```

ì–¼í• ë³´ë©´ ë§ì´ ë˜ëŠ” ë“¯í•˜ì§€ë§Œ ì•„ì§ ìƒì„±ë„ í•˜ì§€ ì•Šì€ `circle`ì„ ì™œ ì„ íƒí•˜ê³  ìˆëŠ”ì§€ ì˜ë¬¸ì´ ìƒê¹ë‹ˆë‹¤. ê° ë‹¨ê³„ê°€ ìƒì„±í•˜ëŠ” `Selection` ê°ì²´ë¥¼ ë³´ê³  íë¦„ì„ ì´í•´í•´ë´…ì‹œë‹¤.

`nodeGroup.selectAll('circle')`ì€ ë‹¹ì—°íˆ ë¹ˆ `Selection` ê°ì²´ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

>ğŸ’¡ ë‹¹ì—°íˆ ë¹„ì–´ìˆëŠ” `Selection` ê°ì²´ë¥¼ ë°›ì„ê±´ë° ì™œ `selectAll`ì„ ì“¸ê¹Œìš”?
>
>ì´í›„ì— `nodes`ë¥¼ ì¶”ê°€í•´ì•¼ í•  ìƒí™©ì´ ìƒê¸´ë‹¤ë©´, ê¸°ì¡´ì— ìƒì„±ë˜ì—ˆë˜ `circle` ìš”ì†Œì™€ `nodes`ë¥¼ ë¹„êµí•˜ì—¬ ì¶”ê°€ëœ `node`ì˜ ê°œìˆ˜ë§Œí¼ `circle` ìš”ì†Œë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤. ì¦‰, ë¹„êµë¥¼ ìœ„í•´ ì„ íƒí•˜ëŠ” ìš”ì†Œì™€ ìƒì„±í•˜ëŠ” ìš”ì†ŒëŠ” ë™ì¼í•´ì•¼ í•©ë‹ˆë‹¤.

```javascript
_groups: [NodeList(0)]
_parents: [g#nodes]
```

`.data(nodes)`ëŠ” ë¹ˆ `Selection` ê°ì²´ì— `nodes` ë°°ì—´ì˜ ê¸¸ì´ë§Œí¼ ì—°ê²°í•©ë‹ˆë‹¤. `jt` ê°ì²´ëŠ” `__data__` propertyì— `node` ì •ë³´ë¥¼ ê°–ê³  ìˆìŠµë‹ˆë‹¤.

```javascript
_enter: [Array(5)]
  0: (5) [jt, jt, jt, jt, jt]
_exit: [Array(0)]
  0: []
_groups: [Array(5)]
  0: (5) [empty Ã— 5]
_parents: [g#nodes]
```

```javascript
_enter: Array(1)
  0: Array(5)
  0: jt {...}
  1: jt {...}
  2: jt {...}
  3: jt {...}
  4: jt
    namespaceURI: "http://www.w3.org/2000/svg"
    ownerDocument: document
    __data__: {id: 5, index: 4, x:...}
_exit: [Array(0)]
_groups: [Array(5)]
_parents: [g#nodes]
```

`.join('circle')`ì€ `.enter().append('circle')`ê³¼ ë™ì¼í•œ ë‹¨ì¶• í‘œí˜„ì…ë‹ˆë‹¤. `.enter()`ê¹Œì§€ ì‹¤í–‰í•œ ê²°ê³¼ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.

```javascript
_groups: Array(1)
  0: (5) [jt, jt, jt, jt, jt]
_parents: [g#nodes]
```

```javascript
_groups: Array(1)
  0: Array(5)
    0: jt {ownerDocument: document, namespaceURI: 'http://www.w3.org/2000/svg', ...}
    1: jt {ownerDocument: document, namespaceURI: 'http://www.w3.org/2000/svg', ...}
    2: jt {ownerDocument: document, namespaceURI: 'http://www.w3.org/2000/svg', ...}
    3: jt {ownerDocument: document, namespaceURI: 'http://www.w3.org/2000/svg', ...}
    4: jt
      namespaceURI: "http://www.w3.org/2000/svg"
      ownerDocument: document
      __data__: {id: 5, index: 4, x: ...}
      ...
_parents: [g#nodes]
```

`enter().append('circle')`ê¹Œì§€ ì‹¤í–‰í•œ ê²°ê³¼ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.

```javascript
_groups: Array(1)
  0: Array(5)
    0: circle
    1: circle
    2: circle
    3: circle
    4: circle
      __data__: {id: 5, index: 4, x:...}
      ...
_parents: [g#nodes]
```

 `circle` ìš”ì†Œê°€ ì—°ê²°ë˜ì—ˆê³  `circle` ë‚´ë¶€ì— `__data__`ê°€ ê²°í•©ë˜ì—ˆìŠµë‹ˆë‹¤.

---

## Impl.

`ticked` í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ DOM ìš”ì†Œì™€ ê²°í•©í•œ `node` ê°ì²´ì˜ `x`, `y` ì¢Œí‘œ ë°ì´í„°ë¥¼ ì´ìš©í•´ ìš”ì†Œë¥¼ í™”ë©´ ìƒì— ê·¸ë ¤ë³´ì•˜ìŠµë‹ˆë‹¤.

<p class="codepen" data-height="600" data-default-tab="result" data-slug-hash="MWrxgPB" data-user="jinyongp" style="height: 600px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;">
  <span>See the Pen <a href="https://codepen.io/jinyongp/pen/MWrxgPB">
  D3 Force (w/  SVG)</a> by Park, Jinyong (<a href="https://codepen.io/jinyongp">@jinyongp</a>)
  on <a href="https://codepen.io">CodePen</a>.</span>
</p>
<script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script>

---

## Conclusion

d3-selectionì˜ ê°œë…ê³¼ ë°ì´í„° ê²°í•© ë°©ë²•ê³¼ íë¦„ì— ëŒ€í•´ ì‚´í´ë³´ì•˜ìŠµë‹ˆë‹¤. ì €ë²ˆê³¼ ë‹¬ë¦¬ ë§ì€ ê°œë…ì— ëŒ€í•´ ì•Œì•„ë³´ì§„ ì•Šì•˜ì§€ë§Œ, ìš”ì†Œë¥¼ ì„ íƒí•˜ê³  ì†ì„±ì„ ë³€ê²½í•˜ê³  ë°ì´í„°ë¥¼ ê²°í•©í•˜ëŠ” ì •ë§ í•„ìš”í•œ ë‚´ìš©ë§Œ ë‹¤ë£¨ë©´ì„œ d3-forceì™€ ì—°ë™í•˜ì—¬ ê°„ë‹¨í•œ ê·¸ë˜í”„ë¥¼ ê·¸ë ¤ë³¼ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.

`node`ì˜ ë°ì´í„°ê°€ ë§ì•„ì§ˆìˆ˜ë¡ d3-selectionì„ ë”ìš± ì ê·¹ì ìœ¼ë¡œ ì´ìš©í•  ì˜ˆì •ì´ë¯€ë¡œ, ê·¸ ë•Œë¥¼ ìœ„í•´ ì´ë²ˆì—” ì´ ì •ë„ë¡œ í•˜ê³  ë‹¤ìŒ ì‹œë¦¬ì¦ˆì—ì„  d3-zoomê³¼ d3-dragë¥¼ ì´ìš©í•˜ì—¬ ìƒí˜¸ì‘ìš©í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.

## References

- [d3-selection](https://github.com/d3/d3-selection)
- [Thinking with Joins](https://bost.ocks.org/mike/join/)
- [D3.js Tutorial - Data Binding](https://lucidar.me/en/d3.js/part-07-data-binding)
