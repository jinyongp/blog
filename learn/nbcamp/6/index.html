<!doctype html><html lang=ko><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-SH0YPW4E1C"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-SH0YPW4E1C")</script><meta charset=utf-8><meta name=viewport viewport-fit=cover content="width=device-width"><meta name=HandheldFriendly content="true"><meta name=robots content="index,follow"><link rel=sitemap type=application/xml href=/sitemap.xml><link rel=canonical href=https://jinyongp.dev/learn/nbcamp/6/><meta name=naver-site-verification content="c36f259891f25bc92e3884c1ceb626a0aaa76146"><link rel=alternate type=application/rss+xml href=https://jinyongp.dev/feed.xml title=jinyongp.dev><meta name=author content="jinyongp <dev.jinyongp@gmail.com>"><meta name=keywords content="iOS,내배캠,내일배움캠프,스파르타코딩클럽,nbcamp,swift,uikit"><link rel=manifest href=/manifest.webmanifest><meta name=mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-title content="jinyongp.dev"><meta name=apple-mobile-web-app-status-bar-style content="default"><meta name=theme-color content="rgb(65, 105, 225)"><meta property="og:site_name" content="jinyongp.dev"><meta property="og:title" content="[내배캠] UIKit 입문 팀 프로젝트"><meta property="og:type" content="website"><meta property="og:url" content="https://jinyongp.dev/learn/nbcamp/6/"><meta property="og:description" content="UIKit 입문 과정을 토대로 Pinterest App을 클론 코딩해보았습니다."><meta name=description content="UIKit 입문 과정을 토대로 Pinterest App을 클론 코딩해보았습니다."><title>[내배캠] UIKit 입문 팀 프로젝트</title><link rel=preload href=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.8.0/build/styles/nord.min.css as=style><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.8.0/build/styles/nord.min.css><script defer type=module>
    import hljs from "https:\/\/cdn.jsdelivr.net\/gh\/highlightjs\/cdn-release@11.8.0\/build/es/highlight.min.js";
    import dart from "https:\/\/cdn.jsdelivr.net\/gh\/highlightjs\/cdn-release@11.8.0\/build/es/languages/dart.min.js";
    hljs.configure({})
    hljs.registerLanguage("dart", dart);
    hljs.highlightAll();
  </script><script async>"serviceWorker"in navigator&&navigator.serviceWorker.register("/js/sw.js")</script><script async type=module src=/js/main.js></script>
<script src=https://unpkg.com/htmx.org@1.9.5></script>
<link rel=icon href=https://jinyongp.dev/favicon.ico><link rel=preload href=https://jinyongp.dev/main.min.css as=style><link rel=stylesheet href=https://jinyongp.dev/main.min.css><link rel=preload href="https://fonts.googleapis.com/css?family=Raleway&amp;display=swap" as=style><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Raleway&amp;display=swap"><style>:root{--accent:65 105 225;--font:Raleway}</style></head><body><nav class=shadow-md><div class="layout flex justify-between text-gray-600"><ul class="flex gap-4 py-4"><li class=hover:text-accent><a hx-boost=true title=Home href=/>Home</a></li><li class=hover:text-accent><a hx-boost=true title=Posts href=/posts>Posts</a></li><li class=hover:text-accent><a hx-boost=true class=text-accent title=Learn href=/learn>Learn</a></li><li class=hover:text-accent><a hx-boost=true title=Series href=/series>Series</a></li></ul><ul class="flex gap-4 py-4"><li class="text-xl hover:text-accent grid place-items-center w-5"><a title=square-envelope href=mailto:dev.jinyongp@gmail.com target=_blank rel="noopener noreferrer nofollow"><i><svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><path d="M64 32C28.7 32 0 60.7.0 96V416c0 35.3 28.7 64 64 64H384c35.3.0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zM218 271.7 64.2 172.4C66 156.4 79.5 144 96 144H352c16.5.0 30 12.4 31.8 28.4L230 271.7c-1.8 1.2-3.9 1.8-6 1.8s-4.2-.6-6-1.8zm29.4 26.9L384 210.4V336c0 17.7-14.3 32-32 32H96c-17.7.0-32-14.3-32-32V210.4l136.6 88.2c7 4.5 15.1 6.9 23.4 6.9s16.4-2.4 23.4-6.9z"/></svg></i></a></li><li class="text-xl hover:text-accent grid place-items-center w-5"><a title=square-velog href=https://velog.io/@jinyongp target=_blank rel="noopener noreferrer nofollow"><i><svg xmlns="http://www.w3.org/2000/svg" height="1em" style="transform:scale(.875)" viewBox="0 0 192 192"><path d="M24 0H168c13.255.0 24 10.7451 24 24V168c0 13.255-10.745 24-24 24H24c-13.2549.0-24-10.745-24-24V24C0 10.7451 10.7451.0 24 0zM49 57.9199V65.48H67l13.6799 77.04L98.5 141.26c17.52-22.2 29.34-38.82 35.46-49.8601C140.2 80.24 143.32 70.9399 143.32 63.5 143.32 59.0601 142 55.7 139.36 53.4199 136.84 51.1399 133.66 50 129.82 50 122.62 50 116.62 53.0601 111.82 59.1799 116.5 62.3 119.68 64.8799 121.36 66.9199c1.8 1.92020000000001 2.7 4.5 2.7 7.74C124.06 80.0601 122.44 86.1799 119.2 93.02 116.08 99.8601 112.66 105.92 108.94 111.2 106.54 114.56 103.48 118.7 99.76 123.62L88.0601 57.2C87.1001 52.3999 84.1001 50 79.0601 50 76.78 50 72.3999 50.96 65.9199 52.8799c-6.48 1.8-12.1199 3.4802-16.9199 5.04z"/></svg></i></a></li><li class="text-xl hover:text-accent grid place-items-center w-5"><a title=square-github href=https://github.com/jinyongp/ target=_blank rel="noopener noreferrer nofollow"><i><svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><path d="M4e2 32H48C21.5 32 0 53.5.0 80v352c0 26.5 21.5 48 48 48h352c26.5.0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM277.3 415.7c-8.4 1.5-11.5-3.7-11.5-8 0-5.4.2-33 .2-55.3.0-15.6-5.2-25.5-11.3-30.7 37-4.1 76-9.2 76-73.1.0-18.2-6.5-27.3-17.1-39 1.7-4.3 7.4-22-1.7-45-13.9-4.3-45.7 17.9-45.7 17.9-13.2-3.7-27.5-5.6-41.6-5.6s-28.4 1.9-41.6 5.6c0 0-31.8-22.2-45.7-17.9-9.1 22.9-3.5 40.6-1.7 45-10.6 11.7-15.6 20.8-15.6 39 0 63.6 37.3 69 74.3 73.1-4.8 4.3-9.1 11.7-10.6 22.3-9.5 4.3-33.8 11.7-48.3-13.9-9.1-15.8-25.5-17.1-25.5-17.1-16.2-.2-1.1 10.2-1.1 10.2 10.8 5 18.4 24.2 18.4 24.2 9.7 29.7 56.1 19.7 56.1 19.7.0 13.9.2 36.5.2 40.6.0 4.3-3 9.5-11.5 8-66-22.1-112.2-84.9-112.2-158.3.0-91.8 70.2-161.5 162-161.5S388 165.6 388 257.4c.1 73.4-44.7 136.3-110.7 158.3zm-98.1-61.1c-1.9.4-3.7-.4-3.9-1.7-.2-1.5 1.1-2.8 3-3.2 1.9-.2 3.7.6 3.9 1.9.3 1.3-1 2.6-3 3zm-9.5-.9c0 1.3-1.5 2.4-3.5 2.4-2.2.2-3.7-.9-3.7-2.4.0-1.3 1.5-2.4 3.5-2.4 1.9-.2 3.7.9 3.7 2.4zm-13.7-1.1c-.4 1.3-2.4 1.9-4.1 1.3-1.9-.4-3.2-1.9-2.8-3.2.4-1.3 2.4-1.9 4.1-1.5 2 .6 3.3 2.1 2.8 3.4zm-12.3-5.4c-.9 1.1-2.8.9-4.3-.6-1.5-1.3-1.9-3.2-.9-4.1.9-1.1 2.8-.9 4.3.6 1.3 1.3 1.8 3.3.9 4.1zm-9.1-9.1c-.9.6-2.6.0-3.7-1.5s-1.1-3.2.0-3.9c1.1-.9 2.8-.2 3.7 1.3 1.1 1.5 1.1 3.3.0 4.1zm-6.5-9.7c-.9.9-2.4.4-3.5-.6-1.1-1.3-1.3-2.8-.4-3.5.9-.9 2.4-.4 3.5.6 1.1 1.3 1.3 2.8.4 3.5zm-6.7-7.4c-.4.9-1.7 1.1-2.8.4-1.3-.6-1.9-1.7-1.5-2.6.4-.6 1.5-.9 2.8-.4 1.3.7 1.9 1.8 1.5 2.6z"/></svg></i></a></li></ul></div></nav><main><div class=layout><header class=text-center><h1 class="relative mt-16 mb-12 flex justify-center items-center gap-2"><i class="absolute translate-y-[-1.8em] text-base md:text-lg hover:text-accent"><a title="View on GitHub Repository" href=https://github.com/nbcamp/pinterest-app target=_blank rel="noopener noreferrer nofollow"><i><svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8.0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8.0-21.5 4.9-32.3 14.6-51.8 45.3.0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8.0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9.0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2.0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8.0-73.5 38.7-73.5 82.6.0 87.8 80.4 101.3 150.4 101.3h48.2c70.3.0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8.0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg></i></a></i>[내배캠] UIKit 입문 팀 프로젝트</h1><div class="flex justify-between items-center"><div><a href=https://jinyongp.dev/tags/nbcamp><kbd class="text-xs bg-accent text-white rounded px-1 py-0.5">nbcamp</kbd></a>
<a href=https://jinyongp.dev/tags/swift><kbd class="text-xs bg-accent text-white rounded px-1 py-0.5">swift</kbd></a>
<a href=https://jinyongp.dev/tags/uikit><kbd class="text-xs bg-accent text-white rounded px-1 py-0.5">uikit</kbd></a></div><span>Written on Sep 4, 2023</span></div><hr class="my-4 w-full"></header><div class="text-slate-500 grid grid-cols-1 gap-2 md:gap-20 md:grid-cols-2"><div><a title="Previous Series ([내배캠] UIKit 입문 개인 과제)" href=/learn/nbcamp/5/ class="flex flex-col gap-1 border border-current text-current rounded p-2 hover:text-accent"><div class="flex items-center gap-1 [&_span]:font-bold"><i class=mb-0.5><svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><path d="M9.4 233.4c-12.5 12.5-12.5 32.8.0 45.3l160 160c12.5 12.5 32.8 12.5 45.3.0s12.5-32.8.0-45.3L109.2 288H416c17.7.0 32-14.3 32-32s-14.3-32-32-32H109.3L214.6 118.6c12.5-12.5 12.5-32.8.0-45.3s-32.8-12.5-45.3.0l-160 160z"/></svg></i><span>PREV</span></div><span class="truncate whitespace-nowrap">[내배캠] UIKit 입문 개인 과제</span></a></div><div><a title="Next Series ([내배캠] UIKit 숙련 개인 과제)" href=/learn/nbcamp/7/ class="flex flex-col gap-1 border border-current text-current rounded p-2 hover:text-accent text-right"><div class="flex items-center gap-1 [&_span]:font-bold justify-end"><span>NEXT</span>
<i class=mb-0.5><svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><path d="M438.6 278.6c12.5-12.5 12.5-32.8.0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3.0s-12.5 32.8.0 45.3L338.8 224H32c-17.7.0-32 14.3-32 32s14.3 32 32 32h306.7L233.4 393.4c-12.5 12.5-12.5 32.8.0 45.3s32.8 12.5 45.3.0l160-160z"/></svg></i></div><span class="truncate whitespace-nowrap">[내배캠] UIKit 숙련 개인 과제</span></a></div></div><hr class=my-4><article class=content><p>6주차가 되었습니다. (2023년 8월 14일 ~ 21일)<br>개인 과제 때 학습한 내용을 기반으로 UIKit을 활용하여 팀 프로젝트를 진행했습니다.</p><p>이번 과제는 팀원의 의견을 수렴하여 스토리보드 없이 코드로 UI를 작성하기로 결정하였습니다. UI 개발에 어려움을 겪을 것이 예상되어, 최대한 심플한 UI와 함께 과제 요구조건에 부합하는 최소 기능을 개발하기로 했습니다. Pinterest App에서 제공하는 UI와 기능이 가장 심플하여 선택하게 되었습니다.</p><p><strong>핀터레스트 앱 디자인</strong></p><div class=grid style=grid-template-columns:repeat(4,minmax(0,1fr));gap:0><img class=mx-auto alt="Pinterest Main Page" src=/image/learn/nbcamp/6/pinterest-main.png>
<img class=mx-auto alt="Pinterest Detail Page" src=/image/learn/nbcamp/6/pinterest-detail.png>
<img class=mx-auto alt="Pinterest Profile Page" src=/image/learn/nbcamp/6/pinterest-profile.png>
<img class=mx-auto alt="Pinterest Edit Profile Page" src=/image/learn/nbcamp/6/pinterest-edit-profile.png></div><p><strong>과제 결과</strong></p><div class=grid style=grid-template-columns:repeat(5,minmax(0,1fr));gap:.5rem><img class=mx-auto alt="Main Page" src=/image/learn/nbcamp/6/result-main-page.png>
<img class=mx-auto alt="Create New Item Page" src=/image/learn/nbcamp/6/result-create-page.png>
<img class=mx-auto alt="Detail Page" src=/image/learn/nbcamp/6/result-detail-page.png>
<img class=mx-auto alt="Profile Page" src=/image/learn/nbcamp/6/result-profile-page.png>
<img class=mx-auto alt="Edit Profile Page" src=/image/learn/nbcamp/6/result-edit-profile-page.png></div><hr><h2 id=프로젝트-목표 class="flex items-center gap-3">프로젝트 목표 <i class="transition opacity-10 hover:opacity-100 text-[0.8em] scale-90 hover:scale-100 -rotate-45 hover:-rotate-90"><a title="프로젝트 목표" href=#%ed%94%84%eb%a1%9c%ec%a0%9d%ed%8a%b8-%eb%aa%a9%ed%91%9c><i><svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><path d="M0 160v96C0 379.7 100.3 480 224 480s224-100.3 224-224V160H320v96c0 53-43 96-96 96s-96-43-96-96V160H0zm0-32H128V64c0-17.7-14.3-32-32-32H32C14.3 32 0 46.3.0 64v64zm320 0H448V64c0-17.7-14.3-32-32-32H352c-17.7.0-32 14.3-32 32v64z"/></svg></i></a></i></h2><ul><li>UITableView / UICollectionView를 활용하며 피드 화면을 구현합니다.</li><li>UITabBarController를 활용해서 다양한 메뉴 화면에 접근할 수 있는 UI를 제공합니다.</li><li>UIStackView와 UIScrollView를 활용하여 프로필 화면을 구현합니다.</li><li>사용자가 상호작용할 수 있는 다양한 기능을 제공합니다.</li><li>UITextView와 UITextField를 활용하여 화면을 구성합니다.</li><li>UIImagePickerController 혹은 PHPickerViewController를 활용하여 사진을 가져옵니다.</li></ul><h2 id=프로젝트-구현 class="flex items-center gap-3">프로젝트 구현 <i class="transition opacity-10 hover:opacity-100 text-[0.8em] scale-90 hover:scale-100 -rotate-45 hover:-rotate-90"><a title="프로젝트 구현" href=#%ed%94%84%eb%a1%9c%ec%a0%9d%ed%8a%b8-%ea%b5%ac%ed%98%84><i><svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><path d="M0 160v96C0 379.7 100.3 480 224 480s224-100.3 224-224V160H320v96c0 53-43 96-96 96s-96-43-96-96V160H0zm0-32H128V64c0-17.7-14.3-32-32-32H32C14.3 32 0 46.3.0 64v64zm320 0H448V64c0-17.7-14.3-32-32-32H352c-17.7.0-32 14.3-32 32v64z"/></svg></i></a></i></h2><p>저는 Main.storyboard 없이 코드로 UI를 작성하기 위해 개발환경을 셋업하는 작업과 UICollectionView를 활용하여 Pinterest 스타일의 CollectionView를 구현하는 작업을 진행했습니다.</p><h3 id=개발환경-셋업 class="flex items-center gap-3">개발환경 셋업 <i class="transition opacity-10 hover:opacity-100 text-[0.8em] scale-90 hover:scale-100 -rotate-45 hover:-rotate-90"><a title="개발환경 셋업" href=#%ea%b0%9c%eb%b0%9c%ed%99%98%ea%b2%bd-%ec%85%8b%ec%97%85><i><svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><path d="M0 160v96C0 379.7 100.3 480 224 480s224-100.3 224-224V160H320v96c0 53-43 96-96 96s-96-43-96-96V160H0zm0-32H128V64c0-17.7-14.3-32-32-32H32C14.3 32 0 46.3.0 64v64zm320 0H448V64c0-17.7-14.3-32-32-32H352c-17.7.0-32 14.3-32 32v64z"/></svg></i></a></i></h3><p>첫번째로 Main.storyboard와 함께 Info.plist와 Targets의 Info 탭에서 Main을 제거했습니다. 그 후, SceneDelegate.swift에서 ViewController를 직접 생성하여 화면에 보여주도록 작성했습니다.</p><p>화면에 첫번째로 보여줄 ContainerViewController인 TabBarController를 작성했습니다. 각 탭에 해당하는 ViewController를 생성하여 TabBarController에 추가해주었습니다.</p><div class="relative rounded-md overflow-hidden my-4 group"><small class="absolute top-0 right-0 bg-black/30 capitalize font-black text-xs text-white rounded-bl-md px-2 py-1 transition-opacity opacity-0 group-hover:opacity-100"><span class=sr-only>Language:</span>swift</small><pre><code class="hljs language-swift">final class TabBarController: UITabBarController {
    override func viewDidLoad() {
        super.viewDidLoad()

        let tabs: [(vc: UIViewController.Type, icon: String)] = [
            (HomeViewController.self, &#34;house&#34;),
            (NewPostViewController.self, &#34;plus.app&#34;),
            (ProfileViewController.self, &#34;person&#34;),
        ]

        setViewControllers(tabs.map { vc, icon in
            let navigationController = UINavigationController(rootViewController: vc.init())
            let tabBarItem = UITabBarItem(title: nil, image: .init(systemName: icon), selectedImage: .init(systemName: &#34;\(icon).fill&#34;))
            navigationController.tabBarItem = tabBarItem
            return navigationController
        }, animated: false)
    }

    override func viewDidLayoutSubviews() {
        super.viewDidLayoutSubviews()

        let paddingTop: CGFloat = 10.0
        tabBar.frame = .init(
            x: tabBar.frame.origin.x,
            y: tabBar.frame.origin.y - paddingTop,
            width: tabBar.frame.width,
            height: tabBar.frame.height &#43; paddingTop
        )
    }
}</code></pre></div><p>그리고 SceneDelegate에서 TabBarController를 생성하여 화면에 보여주도록 작성했습니다.</p><div class="relative rounded-md overflow-hidden my-4 group"><small class="absolute top-0 right-0 bg-black/30 capitalize font-black text-xs text-white rounded-bl-md px-2 py-1 transition-opacity opacity-0 group-hover:opacity-100"><span class=sr-only>Language:</span>swift</small><pre><code class="hljs language-swift">// SceneDelegate.swift
class SceneDelegate: UIResponder, UIWindowSceneDelegate {
    var window: UIWindow?

    func scene(_ scene: UIScene, willConnectTo session: UISceneSession, options connectionOptions: UIScene.ConnectionOptions) {
        guard let windowScene = (scene as? UIWindowScene) else { return }
        window = UIWindow(windowScene: windowScene)
        window?.makeKeyAndVisible()

        AuthService.shared.login()
        let tabBarController = TabBarController()
        window?.rootViewController = tabBarController
    }
    // ...
}</code></pre></div><h3 id=pinterest-스타일의-collectionview-구현 class="flex items-center gap-3">Pinterest 스타일의 CollectionView 구현 <i class="transition opacity-10 hover:opacity-100 text-[0.8em] scale-90 hover:scale-100 -rotate-45 hover:-rotate-90"><a title="Pinterest 스타일의 CollectionView 구현" href=#pinterest-%ec%8a%a4%ed%83%80%ec%9d%bc%ec%9d%98-collectionview-%ea%b5%ac%ed%98%84><i><svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><path d="M0 160v96C0 379.7 100.3 480 224 480s224-100.3 224-224V160H320v96c0 53-43 96-96 96s-96-43-96-96V160H0zm0-32H128V64c0-17.7-14.3-32-32-32H32C14.3 32 0 46.3.0 64v64zm320 0H448V64c0-17.7-14.3-32-32-32H352c-17.7.0-32 14.3-32 32v64z"/></svg></i></a></i></h3><p>Pinterest Style의 CollectionView를 구현하기 위해 Custom FlowLayout을 작성해주었습니다. 또한, JSON 형식의 데이터를 준비하여 메인 페이지에 그려주는 방식으로 구현하였습니다. 네트워크에서 불러온다고 가정하여 비동기로 불러오도록 구현하고 UI를 보여주기 전에 Progress Bar를 작성하여 변환 진척도를 사용자에게 보여주었습니다.</p><h4 id=uicollectionview class="flex items-center gap-3">UICollectionView <i class="transition opacity-10 hover:opacity-100 text-[0.8em] scale-90 hover:scale-100 -rotate-45 hover:-rotate-90"><a title=UICollectionView href=#uicollectionview><i><svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><path d="M0 160v96C0 379.7 100.3 480 224 480s224-100.3 224-224V160H320v96c0 53-43 96-96 96s-96-43-96-96V160H0zm0-32H128V64c0-17.7-14.3-32-32-32H32C14.3 32 0 46.3.0 64v64zm320 0H448V64c0-17.7-14.3-32-32-32H352c-17.7.0-32 14.3-32 32v64z"/></svg></i></a></i></h4><p><code>UICollectionView</code>에서 기본으로 사용되는 <code>UICollectionViewFlowLayout</code>은 높이가 유동적으로 변하는 Cell을 구현하기에 적합하지 않습니다. <a class=underline-lsre href=https://developer.apple.com/library/archive/documentation/WindowsViews/Conceptual/CollectionViewPGforIOS/UsingtheFlowLayout/UsingtheFlowLayout.html target=_blank rel="noopener noreferrer nofollow">해당 문서</a>에 따르면 FlowLayout은 항상 동일한 높이에 아이템을 배치하기 때문에, Cell 간 간격이 일정하지 않고 Cell의 높이에 따라 달라지게 됩니다. 그런 이유로 Pinterest 스타일의 CollectionView를 구현하기 위해서는 Custom FlowLayout을 작성해야 합니다.</p><p><img class=mx-auto alt=CollectionViewFlowLayout src=/image/learn/nbcamp/6/collection-view-flow-layout.png></p><h4 id=pinterestcollectionviewflowlayout class="flex items-center gap-3">PinterestCollectionViewFlowLayout <i class="transition opacity-10 hover:opacity-100 text-[0.8em] scale-90 hover:scale-100 -rotate-45 hover:-rotate-90"><a title=PinterestCollectionViewFlowLayout href=#pinterestcollectionviewflowlayout><i><svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><path d="M0 160v96C0 379.7 100.3 480 224 480s224-100.3 224-224V160H320v96c0 53-43 96-96 96s-96-43-96-96V160H0zm0-32H128V64c0-17.7-14.3-32-32-32H32C14.3 32 0 46.3.0 64v64zm320 0H448V64c0-17.7-14.3-32-32-32H352c-17.7.0-32 14.3-32 32v64z"/></svg></i></a></i></h4><details class="rounded group my-2 border border-accent/20 p-2 px-3"><summary class="peer list-none flex items-center justify-between cursor-pointer text-slate-600 hover:text-accent transition-colors">전체 코드 보기
<span class="text-xs text-current before:content-['EXPAND'] before:group-open:content-['COLLAPSE']"></span></summary><div class=border-y><p><div class="relative rounded-md overflow-hidden my-4 group"><small class="absolute top-0 right-0 bg-black/30 capitalize font-black text-xs text-white rounded-bl-md px-2 py-1 transition-opacity opacity-0 group-hover:opacity-100"><span class=sr-only>Language:</span>swift</small><pre><code class="hljs language-swift">import UIKit

@objc protocol PinterestCollectionViewDelegateFlowLayout: AnyObject {
    @objc optional func collectionView(_ collectionView: UICollectionView, layout: UICollectionViewLayout, contentHeightAt indexPath: IndexPath) -&gt; CGFloat
    @objc optional func collectionView(_ collectionView: UICollectionView, layout: UICollectionViewLayout, contentPaddingForSectionAt section: Int) -&gt; CGFloat
}

final class PinterestCollectionViewFlowLayout: UICollectionViewFlowLayout {
    var numberOfColumns = 1
    var contentPadding: CGFloat = 0
    var headerHeight: CGFloat = 0

    weak var delegate: PinterestCollectionViewDelegateFlowLayout?

    private var attributesCache: [UICollectionViewLayoutAttributes] = []
    private var columnHeights: [CGFloat] = []

    override var collectionViewContentSize: CGSize {
        guard let collectionView else { return .zero }
        return .init(
            width: collectionView.bounds.width,
            height: (columnHeights.max() ?? 0) &#43; headerHeight * 2)
    }

    override func prepare() {
        super.prepare()
        guard let collectionView else { return }

        attributesCache = []
        columnHeights = .init(repeating: 0, count: numberOfColumns)

        for section in 0..&lt;collectionView.numberOfSections {
            let contentPadding = delegate?.collectionView?(collectionView, layout: self, contentPaddingForSectionAt: section) ?? contentPadding
            let contentWidth = (collectionView.bounds.width - (CGFloat(numberOfColumns &#43; 1) * contentPadding)) / CGFloat(numberOfColumns)
            let columnOffsets: [CGFloat] = (0..&lt;numberOfColumns).map { CGFloat($0) * (contentWidth &#43; contentPadding) &#43; contentPadding }

            var column = 0
            for item in 0..&lt;collectionView.numberOfItems(inSection: section) {
                let indexPath = IndexPath(item: item, section: section)
                let contentHeight = contentPadding * 2 &#43; (delegate?.collectionView?(collectionView, layout: self, contentHeightAt: indexPath) ?? contentWidth)
                let attributes = UICollectionViewLayoutAttributes(forCellWith: indexPath)
                attributes.frame = CGRect(x: columnOffsets[column], y: columnHeights[column] &#43; headerHeight &#43; contentPadding, width: contentWidth, height: contentHeight)
                attributesCache.append(attributes)

                columnHeights[column] = columnHeights[column] &#43; contentHeight &#43; contentPadding
                column = (column &#43; 1) % numberOfColumns
            }
        }
    }

    override func layoutAttributesForElements(in rect: CGRect) -&gt; [UICollectionViewLayoutAttributes]? {
        var attributes = attributesCache.filter { $0.frame.intersects(rect) }
        if let headerAttributes = layoutAttributesForSupplementaryView(ofKind: UICollectionView.elementKindSectionHeader, at: IndexPath(item: 0, section: 0)) {
            attributes.append(headerAttributes)
        }
        return attributes
    }

    override func layoutAttributesForSupplementaryView(ofKind elementKind: String, at indexPath: IndexPath) -&gt; UICollectionViewLayoutAttributes? {
        if elementKind == UICollectionView.elementKindSectionHeader {
            let attributes = UICollectionViewLayoutAttributes(forSupplementaryViewOfKind: elementKind, with: indexPath)
            attributes.frame = .init(x: 0, y: 0, width: collectionView?.frame.width ?? 0, height: headerHeight)
            return attributes
        }
        return nil
    }

    override func layoutAttributesForItem(at indexPath: IndexPath) -&gt; UICollectionViewLayoutAttributes? {
        attributesCache[indexPath.item]
    }
}</code></pre></div></p></div><div class="text-slate-500 transition-colors text-xs text-right">전체 코드 보기</div></details><p>Custom FlowLayout을 작성하기 위해서 <code>UICollectionViewFlowLayout</code>을 상속합니다. 그리고 몇가지 프로퍼티와 함수를 오버라이드해야 합니다.</p><ul><li><code>collectionViewContentSize</code>: CollectionView의 ContentSize를 반환합니다. Cell의 높이에 따라 CollectionView의 높이가 유동적으로 변하므로 이를 계산해야 합니다.</li><li><code>prepare</code>: CollectionView의 레이아웃을 준비합니다. Cell의 위치를 계산하고, CollectionView의 ContentSize를 계산한 뒤에 메모리에 저장해둡니다. <code>IndexPath</code>에 대응하는 레이아웃 속성을 저장합니다.</li><li><code>layoutAttributesForElements</code>: CollectionView의 레이아웃을 반환합니다. <code>prepare</code>에서 계산한 레이아웃을 반환합니다.</li><li><code>layoutAttributesForItem</code>: <code>IndexPath</code>에 대응하는 레이아웃을 반환합니다. <code>prepare</code>에서 계산한 레이아웃을 반환합니다.</li></ul><p>모든 Cell의 높이가 다르므로 Cell의 높이를 저장하고 있을 속성이 필요합니다. 클래스에 <code>contentHeights</code> 속성을 선언하고 <code>prepare</code>에서 계산한 높이를 저장합니다.</p><div class="relative rounded-md overflow-hidden my-4 group"><small class="absolute top-0 right-0 bg-black/30 capitalize font-black text-xs text-white rounded-bl-md px-2 py-1 transition-opacity opacity-0 group-hover:opacity-100"><span class=sr-only>Language:</span>swift</small><pre><code class="hljs language-swift">private var columnHeights: [CGFloat] = []</code></pre></div><p><code>prepare</code>이 실행되면 <code>contentHeights</code>를 column의 개수만큼의 요소를 가진 배열로 초기화합니다. 그리고 CollectionView가 가진 요소를 모두 순회하며 너비와 높이를 계산합니다.</p><ul><li><code>contentWidth</code>: CollectionView의 너비와 열 개수를 통해 구한 하나의 열의 너비입니다.</li><li><code>contentHeight</code>: 외부에서 주입된 높이 값입니다.</li></ul><p>이를 기반으로 Cell의 위치를 계산하여 frame을 생성한 뒤, <code>attributesCache</code>에 저장합니다.</p><p><code>contentHeights</code>에 Cell의 높이를 모두 저장합니다. <code>column</code> 속성을 통해 현재 순회가 몇 번째 위치에 열인지 저장합니다.</p><div class="relative rounded-md overflow-hidden my-4 group"><small class="absolute top-0 right-0 bg-black/30 capitalize font-black text-xs text-white rounded-bl-md px-2 py-1 transition-opacity opacity-0 group-hover:opacity-100"><span class=sr-only>Language:</span>swift</small><pre><code class="hljs language-swift">override func prepare() {
    super.prepare()
    guard let collectionView else { return }

    attributesCache = []
    columnHeights = .init(repeating: 0, count: numberOfColumns)

    for section in 0..&lt;collectionView.numberOfSections {
        let contentPadding = delegate?.collectionView?(collectionView, layout: self, contentPaddingForSectionAt: section) ?? contentPadding
        let contentWidth = (collectionView.bounds.width - (CGFloat(numberOfColumns &#43; 1) * contentPadding)) / CGFloat(numberOfColumns)
        let columnOffsets: [CGFloat] = (0..&lt;numberOfColumns).map { CGFloat($0) * (contentWidth &#43; contentPadding) &#43; contentPadding }

        var column = 0
        for item in 0..&lt;collectionView.numberOfItems(inSection: section) {
            let indexPath = IndexPath(item: item, section: section)
            let contentHeight = contentPadding * 2 &#43; (delegate?.collectionView?(collectionView, layout: self, contentHeightAt: indexPath) ?? contentWidth)
            let attributes = UICollectionViewLayoutAttributes(forCellWith: indexPath)
            attributes.frame = CGRect(x: columnOffsets[column], y: columnHeights[column] &#43; headerHeight &#43; contentPadding, width: contentWidth, height: contentHeight)
            attributesCache.append(attributes)

            columnHeights[column] = columnHeights[column] &#43; contentHeight &#43; contentPadding
            column = (column &#43; 1) % numberOfColumns
        }
    }
}</code></pre></div><p><code>attributesCache</code>는 <code>UICollectionViewLayoutAttributes</code> 타입으로 Cell의 위치와 크기를 저장합니다. 이는 <code>layoutAttributesForElements</code>와 <code>layoutAttributesForItem</code>에서 사용됩니다.</p><ul><li><code>layoutAttributesForElements</code>: <code>attributesCache</code>에서 현재 보이는 화면인 <code>rect</code>와 겹치는 레이아웃을 반환합니다.</li><li><code>layoutAttributesForItem</code>: <code>attributesCache</code>에서 <code>indexPath</code>에 해당하는 레이아웃을 반환합니다.</li></ul><div class="relative rounded-md overflow-hidden my-4 group"><small class="absolute top-0 right-0 bg-black/30 capitalize font-black text-xs text-white rounded-bl-md px-2 py-1 transition-opacity opacity-0 group-hover:opacity-100"><span class=sr-only>Language:</span>swift</small><pre><code class="hljs language-swift">override func layoutAttributesForElements(in rect: CGRect) -&gt; [UICollectionViewLayoutAttributes]? {
    attributesCache.filter { $0.frame.intersects(rect) }
}

override func layoutAttributesForItem(at indexPath: IndexPath) -&gt; UICollectionViewLayoutAttributes? {
    attributesCache[indexPath.item]
}</code></pre></div><p>마지막으로 <code>collectionViewContentSize</code>를 오버라이드하여 CollectionView의 ContentSize를 반환합니다. <code>columnHeights</code>에서 최대 높이를 가져와서 반환합니다.</p><div class="relative rounded-md overflow-hidden my-4 group"><small class="absolute top-0 right-0 bg-black/30 capitalize font-black text-xs text-white rounded-bl-md px-2 py-1 transition-opacity opacity-0 group-hover:opacity-100"><span class=sr-only>Language:</span>swift</small><pre><code class="hljs language-swift">override var collectionViewContentSize: CGSize {
    guard let collectionView else { return .zero }
    return .init(
        width: collectionView.bounds.width,
        height: (columnHeights.max() ?? 0) &#43; headerHeight * 2)
}</code></pre></div><p>이로써 Pinterest 스타일의 CollectionView를 구현할 수 있습니다.</p><h2 id=회고 class="flex items-center gap-3">회고 <i class="transition opacity-10 hover:opacity-100 text-[0.8em] scale-90 hover:scale-100 -rotate-45 hover:-rotate-90"><a title=회고 href=#%ed%9a%8c%ea%b3%a0><i><svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><path d="M0 160v96C0 379.7 100.3 480 224 480s224-100.3 224-224V160H320v96c0 53-43 96-96 96s-96-43-96-96V160H0zm0-32H128V64c0-17.7-14.3-32-32-32H32C14.3 32 0 46.3.0 64v64zm320 0H448V64c0-17.7-14.3-32-32-32H352c-17.7.0-32 14.3-32 32v64z"/></svg></i></a></i></h2><p>이번 과제에서는 CollectionViewFlowLayout에 대해 알아보고 Pinterest 스타일의 레이아웃을 직접 작성해보았습니다. <code>frame</code>을 활용해서 Cell의 높이와 너비 그리고 x, y 좌표를 설정해서 직접 배치하는 방법으로 UI을 그리는 방법이 생각보다 동작을 잘해서 놀라웠던 경험이었습니다. 이를 구현하기 위해 여러 UICollectionView 사용방법을 보면서 이 뿐만 아니라 굉장히 다양한 용도로 사용하고 있었고, 또 애플에서 제공하는 기능이 훨씬 방대해서 UICollectionView를 더 많이 다양하게 사용해볼 필요성을 느꼈습니다.</p></article><script src=https://giscus.app/client.js data-repo=jinyongp/jinyongp.dev data-repo-id=R_kgDOHJDtcg data-category=Comments data-category-id=DIC_kwDOHJDtcs4CXf7o data-mapping=title data-strict=0 data-reactions-enabled=0 data-emit-metadata=0 data-input-position=top data-theme=light data-lang=ko crossorigin=anonymous async></script><div class=h-24></div></div></main><footer class="absolute bottom-0 w-full"><div class="flex justify-center py-8"><p class="[&_a]:text-accent text-center text-sm">Copyright 2023. Jinyong Park. All rights reserved.<br><span class=text-xs>Powered by
<a title="Go to Hugo Site" href=https://gohugo.io target=_blank rel="noopener noreferrer nofollow">Hugo</a>
| Developed on
<a title="Go to Github Repo" href=https://github.com/jinyongp/jinyongp.github.io target=_blank rel="noopener noreferrer nofollow">Here</a></span></p></div></footer><div id=js-scroll-back-to-top class="back-to-top hide"><i class=text-accent><svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 576 512"><path d="M288 0c17.7.0 32 14.3 32 32V49.7C451.8 63.4 557.7 161 573.9 285.9c2 15.6-17.3 24.4-27.8 12.7C532.1 283 504.8 272 480 272c-38.7.0-71 27.5-78.4 64.1-1.7 8.7-8.7 15.9-17.6 15.9s-15.8-7.2-17.6-15.9C359 299.5 326.7 272 288 272s-71 27.5-78.4 64.1c-1.7 8.7-8.7 15.9-17.6 15.9s-15.8-7.2-17.6-15.9C167 299.5 134.7 272 96 272c-24.8.0-52.1 11-66.1 26.7C19.4 310.4.1 301.5 2.1 285.9 18.3 161 124.2 63.4 256 49.7V32c0-17.7 14.3-32 32-32zm0 304c12.3.0 23.5 4.6 32 12.2V430.6c0 45-36.5 81.4-81.4 81.4-30.8.0-59-17.4-72.8-45l-2.3-4.7c-7.9-15.8-1.5-35 14.3-42.9s35-1.5 42.9 14.3l2.3 4.7c3 5.9 9 9.6 15.6 9.6 9.6.0 17.4-7.8 17.4-17.4V316.2c8.5-7.6 19.7-12.2 32-12.2z"/></svg></i></div></body></html>